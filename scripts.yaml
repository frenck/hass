delay_notify:
  alias: Delay Notify
  sequence:
    - service_template: >
        {% if target == 'discord' %}
          notify.discord_webhook
        {% elif target == 'ios' %}
          notify.mobile_app_nathans_iphone
        {% endif %}
      data_template:
        title: "{{ airport }} delay!"
        message: >
          {{ airport }}{% if type == 'GDP' %} went into a ground delay program! {% elif type == 'GS' %} went into a ground stop that ends at {{ endtime }}! {% elif type == 'GSCX' %} ground stop canceled.{% endif %}
adam_mp3:
  alias: Tell Me How You Really Feel
  sequence:
    - service: script.marantz_speak
      data:
        mp3filename: "adam"
marantz_speak:
  alias: Marantz Speak
  sequence:
    - service: media_player.clear_playlist
      data:
        entity_id: media_player.marantz_sr5012
    - service: media_player.volume_set
      data:
        entity_id: media_player.marantz_sr5012
        volume_level: "0.6"
    - service: media_player.play_media
      data_template:
        entity_id: media_player.marantz_sr5012
        media_content_type: "url"
        media_content_id: "https://raw.githubusercontent.com/ntilley905/hass/script-test/mp3/{{ mp3filename }}.mp3"
    - condition: template
      value_template: "{{ loop == 'yes'}}"
    - service: script.script_loop
      data_template:
        script_to_loop: script.marantz_speak
        loop_delay: 5
        mp3filename: {{ mp3filename }}
        loop: {{ loop }}
script_loop:
  alias: Loop a Passed Script
  sequence:
    - delay: "{{ loop_delay }}"
    - service_template: "{{ script_to_loop }}"
      data_template:
        mp3filename: {{ mp3filename }}
        loop: {{ loop }}
