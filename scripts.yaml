delay_notify:
  alias: Delay Notify
  sequence:
    - service_template: >
        {% if target == 'discord' %}
          notify.discord_webhook
        {% elif target == 'ios' %}
          notify.mobile_app_nathans_iphone
        {% endif %}
      data_template:
        title: "{{ airport }} delay!"
        message: >
          {{ airport }}{% if type == 'GDP' %} went into a ground delay program! {% elif type == 'GS' %} went into a ground stop that ends at {{ endtime }}! {% elif type == 'GSCX' %} ground stop canceled.{% endif %}
adam_mp3:
  alias: Tell Me How You Really Feel
  sequence:
    - service: script.marantz_speak
      data:
        mp3filename: "adam"
marantz_speak:
  alias: Marantz Speak
  sequence:
    - service: media_player.clear_playlist
      data:
        entity_id: media_player.marantz_sr5012
    - service: media_player.volume_set
      data:
        entity_id: media_player.marantz_sr5012
        volume_level: "0.6"
    - service: media_player.play_media
      data_template:
        entity_id: media_player.marantz_sr5012
        media_content_type: "url"
        media_content_id: "https://raw.githubusercontent.com/ntilley905/hass/master/mp3/{{ mp3filename }}.mp3"
    - condition: template
      value_template: "{{ loop == 'yes'}}"
    - delay: 5
    - service: script.script_loop
      data_template:
        script_to_loop: script.marantz_speak
        loop_delay: 5
        mp3filename: "{{ mp3filename }}"
        loop: "{{ loop }}"
script_loop:
  alias: Loop a Passed Script
  sequence:
    - delay: "{{ loop_delay }}"
    - service_template: "{{ script_to_loop }}"
      data_template:
        mp3filename: "{{ mp3filename }}"
        loop: "yes"
        loop_delay: "{{ loop_delay }}"
script_loop_stop:
  alias: Stop Looping Script
  sequence:
    - service: homeassistant.turn_off
      data:
        entity_id: group.loopable_scripts
flash_lights:
  alias: Flash Lights
  sequence:
    - service: light.turn_on
      entity_id: light.kitchen_lights
    - delay: 1
    - service: light.turn_off
      entity_id: light.kitchen_lights
    - service: script.script_loop
      data:
        script_to_loop: script.flash_lights
        loop_delay: 1
alarm_clock:
  alias: Alarm Clock
  sequence:
    - service: input_boolean.turn_off
      entity_id: input_boolean.sleep_mode
    - service: light.turn_on
      data:
        entity_id: light.tv_backlight
        kelvin: 4500
        brightness: 255
        transition: 60
    - delay: '00:00:30'
    - service: light.turn_on
      data:
        entity_id: light.bedroom_lamp
        kelvin: 4500
        brightness: 255
        transition: 60
    - delay: '00:01:00'
    - service: light.turn_on
      entity_id: light.bedroom_light
    - service: notify.mobile_app_nathans_iphone
      data:
        title: "Good Morning"
        message: "Time to start the day."
        data:
          push:
            category: "alarm_clock"
            sound:
              name: default
              critical: 1
              volume: 1.0
    - condition: state
      entity_id: input_boolean.alarm_clock_coffee
      state: 'on'
    - service: switch.turn_on
      entity_id: switch.coffee_maker
morning_tts:
  alias: Morning TTS
  sequence:
    service: tts.google_translate_say
    data_template:
      entity_id: media_player.volumio_mpd
      message: "Good morning! The current time is {{ now().strftime('%H:%M') }}. Today's weather is {{ states('sensor.dark_sky_summary_0d') }} Here's the news."
